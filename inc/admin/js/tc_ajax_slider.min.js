var CzrSlider;!function(a){"use strict";a(function(){CzrSlider=function(){this.$body=a("body"),this._action="slider_action",this._nonce=SliderAjax.SliderCheckNonce,this.$_slider_section_box=a("#slider_sectionid"),this.$_slider_fields_box=a("#slider-fields-box"),this.$_tc_post_id=a("input#tc_post_id"),this._check_field="slider_check_field",this._context="attachment",a("input#post_slider_check_field").length>0&&(this._check_field="post_slider_check_field",this._context="post"),this.$_slider_check_field=a("input#"+this._check_field),this._color_picker_on="post"!=this.$_context,this._color_picker_on&&(this._color_picker_func="object"==typeof jQuery.wp&&"function"==typeof jQuery.wp.wpColorPicker?"wpColorPicker":"farbtastic"),this._data={action:this._action,tc_post_id:this.$_tc_post_id.val(),SliderCheckNonce:this._nonce,tc_post_type:this._context},this.eventListeners(),this._init_sortable(),this._init_multipicker()},a.extend(CzrSlider.prototype,{eventListeners:function(){var a=this;this.$body.on("change","input#"+this._check_field,function(){a.ajax(a._build_data("enable"))}).on("change","select#post_slider_field",function(){a.ajax(a._build_data("select_slider"))}).on("sortupdate","#slider_sectionid #sortable",function(b,c){a.ajax(a._build_data("reorder_slides"),"_reorder_slides_response")}).on("click","#tc_create_slider",function(){a.ajax(a._build_data("new_slider"))}).on("click","#delete-slider",function(){a.ajax(a._build_data("delete_slider"))})},ajax:function(b,c){var d=this;this.$_slider_fields_box.find(".spinner").show(),a.post(ajaxurl,b,function(a){return c?void d[c](a):void d._default_response(a)})},_default_response:function(a){this.$_slider_fields_box.empty().append(a),this.$_slider_fields_box.find(".spinner").hide(),this._init_ext_plugins()},_reorder_slides_response:function(b){var c=a("<div/>").addClass("updated").css("opacity",0).html('<div class="message">Slider updated</div>').appendTo("#update-status");c.animate({opacity:.9},function(){c.delay(1200).fadeOut(function(){c.remove()})}),this.$_slider_fields_box.find(".spinner").hide(),this._init_sortable()},_build_data:function(b){var c={};switch(b){case"new_slider":case"select_slider":c=a.extend({},this._data,{post_slider_name:a("select#post_slider_field").val(),new_slider_name:a("input#slider_field").val()}),"attachment"==this._context&&a.extend(c,this._data,{slide_title_field:a("input#slide_title_field").val(),slide_text_field:a("textarea#slide_text_field").val(),slide_color_field:a("input#slide_color_field").val(),slide_button_field:a("input#slide_button_field").val(),slide_link_field:a("select#slide_link_field").val(),slide_custom_link_field:a("input#slide_custom_link_field").val(),slide_link_target_field:a("input#slide_link_target_field").is(":checked")?1:"",slide_link_whole_slide_field:a("input#slide_link_whole_slide_field").is(":checked")?1:""});break;case"delete_slider":c=a.extend({},this._data,{delete_slider:!0,currentpostslider:a("select#post_slider_field").val(),new_slider_name:null});break;case"reorder_slides":c=a.extend({},this._data,{newOrder:this.$_slider_section_box.find("#sortable").sortable("toArray").toString(),currentpostslider:a("select#post_slider_field").val()});break;default:c=this._data}return c[this._check_field]=this.$_slider_check_field.is(":checked")?1:"",c},_init_ext_plugins:function(){this._init_color_picker(),this._init_iphone_check(),this._init_sortable(),this._init_multipicker()},_init_color_picker:function(){if(this._color_picker_on){var b=a("#slide_color_field");switch(this._color_picker_func){case"farbtastic":a("#colorfield").farbtastic(b);break;default:b.wpColorPicker()}}},_init_iphone_check:function(){a(".iphonecheck").iphoneStyle({checkedLabel:"Yes",uncheckedLabel:"No"})},_init_sortable:function(){this.$_slider_section_box.find("#sortable").sortable({placeholder:"ui-state-highlight"}).disableSelection()},_init_multipicker:function(){function b(a){return a.text.replace(/\u2013|\u2014/g,"")}"function"==typeof a.fn.select2&&this.$_slider_section_box.find("select.tc_multiple_picker").select2({closeOnSelect:!1,formatSelection:b})}}),new CzrSlider})}(jQuery);